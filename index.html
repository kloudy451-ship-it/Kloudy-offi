<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Coder PRO v11.4</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/editor/editor.main.min.css">
    <style>
        :root { --accent: #00d2ff; --bg: #000810; --err: #ff4b4b; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: monospace; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Экран блокировки */
        #auth-screen {
            position: fixed; inset: 0; background: #000810; z-index: 10000;
            display: flex; justify-content: center; align-items: center;
        }
        .auth-box { border: 1px solid var(--accent); padding: 30px; text-align: center; border-radius: 8px; background: rgba(0, 210, 255, 0.05); }
        input { background: #000; border: 1px solid var(--accent); color: var(--accent); padding: 10px; font-size: 20px; width: 150px; text-align: center; outline: none; margin-bottom: 15px; }
        .btn { background: var(--accent); color: #000; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; width: 100%; }
        #auth-err { color: var(--err); font-size: 12px; margin-top: 10px; display: none; }

        /* Интерфейс */
        #main-ui { display: none; flex-direction: column; height: 100vh; }
        header { padding: 10px; border-bottom: 1px solid var(--accent); display: flex; justify-content: space-between; }
        #workspace { display: flex; flex: 1; }
        #editor { flex: 1; height: 100%; }
        
        .shake { animation: shake 0.3s; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(5px)} 75%{transform:translateX(-5px)} }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="auth-box">
        <div style="color: var(--accent); margin-bottom: 15px; letter-spacing: 2px;">SECURE ACCESS</div>
        <input type="tel" id="pass-field" placeholder="PIN" maxlength="4">
        <div id="auth-err">ДОСТУП ЗАПРЕЩЕН</div>
        <button class="btn" onclick="handleAuth()">ВОЙТИ</button>
    </div>
</div>

<div id="main-ui">
    <header>
        <div style="color: var(--accent);">CODER_PRO_OS</div>
        <button class="btn" style="width:auto; padding: 2px 10px;" onclick="location.reload()">LOGOUT</button>
    </header>
    <div id="workspace">
        <div id="editor"></div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader.min.js"></script>

<script>
    // <span style="color:red">ВАЖНО: Эти функции ДОЛЖНЫ быть глобальными!</span>
    const AUTH_HASH = "858e388703f8229b132801e05d93378546f3330364f9b8c0a876a40a233b664d"; // Для "3268"

    async function sha256(str) {
        const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
        return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    async function handleAuth() {
        const input = document.getElementById('pass-field').value;
        const err = document.getElementById('auth-err');
        
        try {
            const hashed = await sha256(input);
            if (hashed === AUTH_HASH) {
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('main-ui').style.display = 'flex';
                initEditor();
            } else {
                throw new Error("Wrong pin");
            }
        } catch (e) {
            err.style.display = 'block';
            document.querySelector('.auth-box').classList.add('shake');
            setTimeout(() => document.querySelector('.auth-box').classList.remove('shake'), 300);
            document.getElementById('pass-field').value = '';
        }
    }

    function initEditor() {
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs' } });
        require(['vs/editor/editor.main'], function() {
            window.editor = monaco.editor.create(document.getElementById('editor'), {
                value: "// Доступ разрешен\nconsole.log('System initialized');",
                language: 'javascript',
                theme: 'vs-dark',
                automaticLayout: true
            });
        });
    }

    // Слушатель Enter
    document.getElementById('pass-field').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') handleAuth();
    });
</script>
</body>
</html>
